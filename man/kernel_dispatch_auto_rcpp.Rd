% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{kernel_dispatch_auto_rcpp}
\alias{kernel_dispatch_auto_rcpp}
\title{Kernel Dispatcher (Dense + Sparse Support)}
\usage{
kernel_dispatch_auto_rcpp(
  X_s,
  Y_s,
  l,
  h,
  v,
  degree,
  c,
  d,
  W_s,
  kernel,
  use_symmetry = FALSE
)
}
\arguments{
\item{l}{Length scale (>0) for distance kernels}

\item{h}{Scale factor / marginal standard deviation}

\item{v}{Smoothness parameter (`nu`) for Matern or shape for Cauchy}

\item{degree}{Polynomial degree (integer >=1) for polynomial kernel}

\item{c}{Bias term for linear/polynomial kernels}

\item{d}{Derivative order: 0, 1, or 2}

\item{kernel}{Kernel type (string): `"gaussian"`, `"matern"`, `"cauchy"`, `"triangular"`, `"spherical"`, `"linear"`, `"polynomial"`}

\item{use_symmetry}{Logical; if TRUE, enforces symmetry (only valid for square X/Y distance matrices)}

\item{X}{Dense numeric matrix or sparse dgCMatrix (distance matrix for distance kernels)}

\item{Y}{Dense numeric matrix or sparse dgCMatrix (same dimensions as X)}

\item{W}{Dense or sparse weight matrix, same dimensions as X/Y, scales derivatives elementwise}
}
\value{
Kernel matrix (dense `MatrixXd` if inputs are dense, sparse `dgCMatrix` if inputs are sparse)
}
\description{
Computes kernel matrices for a variety of kernels, supporting both dense feature matrices
and sparse distance matrices (dgCMatrix). Automatically dispatches to optimized implementations
depending on the kernel type and input format.
}
\details{
Supported kernels:
* Distance-based kernels (sparse/dense): `"gaussian"`, `"matern"`, `"cauchy"`, `"triangular"`, `"spherical"`
* Feature/Gram kernels (dense only): `"linear"`, `"polynomial"`

Derivatives are supported via the `d` argument:
* `d = 0`: Kernel values
* `d = 1`: First derivative
* `d = 2`: Second derivative

Symmetry enforcement (`use_symmetry = TRUE`) works for square distance matrices only.
}
\examples{
# Dense Gaussian kernel
X <- matrix(rnorm(20), 5, 4)
W <- matrix(1, nrow(X), nrow(X))
k <- kernel_dispatch_auto_rcpp(X, X, l=1, h=1, v=0, degree=0, c=0, d=0, W, "gaussian", TRUE)

# Sparse distance-based Matern kernel
library(Matrix)
R <- as(Matrix(dist(matrix(rnorm(25),5,5))), "dgCMatrix")
Wsp <- Matrix(1,5,5,sparse=TRUE)
Ksp <- kernel_dispatch_auto_rcpp(R, R, l=1, h=1, v=1.5, degree=0, c=0, d=0, Wsp, "matern", TRUE)
}
